lm.fit=lm(ERA~.,data=training)
summary(lm.fit)
lm.fit=lm(ERA~.-ERAZ-HR.9.1-HR.FB,data=training)
summary(lm.fit)
lm.fit=lm(ERA~.-ERAZ-HR.9.1-HR.FB-LOB.,data=training)
summary(lm.fit)
lm.fit=lm(ERA~.-ERAZ-HR.9.1-HR.FB-LOB.-BABIP,data=training)
summary(lm.fit)
lm.fit=lm(ERA~.-ERAZ-HR.9.1-HR.FB-LOB.-BABIP-GB.,data=training)
summary(lm.fit)
lm.fit=lm(ERA~.-ERAZ-HR.9.1-HR.FB-LOB.-BABIP-GB.-xFIP,data=training)
summary(lm.fit)
lm.fit=lm(ERA~.-ERAZ-HR.9.1-HR.FB-LOB.-BABIP-GB.-xFIP-W,data=training)
summary(lm.fit)
lm.fit=lm(ERA~.-ERAZ-HR.9.1-HR.FB-LOB.-BABIP-GB.-xFIP-W-WAR,data=training)
summary(lm.fit)
lm.fit=lm(ERA~.-ERAZ-HR.9.1-HR.FB-LOB.-BABIP-GB.-xFIP-W-WAR-IP,data=training)
summary(lm.fit)
lm.fit=lm(ERA~.-ERAZ-HR.9.1-HR.FB-LOB.-BABIP-GB.-xFIP-W-WAR-Season,data=training)
summary(lm.fit)
lm.fit=lm(ERA~.-ERAZ-HR.9.1-HR.FB-LOB.-BABIP-GB.-xFIP-W-WAR-IP-Season,data=training)
summary(lm.fit)
lm.fit=lm(ERA~.-ERAZ-HR.9.1-HR.FB-LOB.-BABIP-GB.-xFIP-W-WAR,data=training)
summary(lm.fit)
sqrt(mean((lm.fit$pred-training$ERA)^2))

knn.5=knn.reg(training,y=training$ERA,k=5)
knn.5$pred
sqrt(mean((knn.5$pred-training$ERA)^2))
knn.10=knn.reg(training,y=training$ERA,k=10)
knn.10$pred
sqrt(mean((knn.10$pred-training$ERA)^2))
knn.15=knn.reg(training,y=training$ERA,k=15)
knn.15$pred
sqrt(mean((knn.15$pred-training$ERA)^2))
knn.20=knn.reg(training,y=training$ERA,k=20)
sqrt(mean((knn.20$pred-training$ERA)^2))
knn.30=knn.reg(training,y=training$ERA,k=30)
sqrt(mean((knn.30$pred-training$ERA)^2))
knn.40=knn.reg(training,y=training$ERA,k=40)
sqrt(mean((knn.40$pred-training$ERA)^2))
knn.4=knn.reg(training,y=training$ERA,k=4)
sqrt(mean((knn.4$pred-training$ERA)^2))
knn.3=knn.reg(training,y=training$ERA,k=3)
sqrt(mean((knn.3$pred-training$ERA)^2))
knn.2=knn.reg(training,y=training$ERA,k=2)
sqrt(mean((knn.3$pred-training$ERA)^2))
knn.6=knn.reg(training,y=training$ERA,k=6)
sqrt(mean((knn.6$pred-training$ERA)^2))

lm.fit=lm(ERA~.-ERAZ-HR.9.1-HR.FB-LOB.-BABIP-GB.-xFIP-W-WAR,data=training)
pred1=predict(lm.fit,test)
sqrt(mean((pred1-test$ERA)^2))
library(FNN)
knn.pred=knn.reg(training, test,y=test$ERA, k=4)
RMSE=sqrt(mean((knn.pred-test$ERA)^2))
knn.pred
test$ERA
knn.pred-test$ERA
knn.pred-test[,15]
a=as.vector(knn.pred)
b=as.vector(test$ERA)
a-b
mean(test[,15])

